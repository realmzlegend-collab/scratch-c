<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scratch C - Login</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: rgba(30, 30, 30, 0.95);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            border: 2px solid #FFD700;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            text-align: center;
        }
        
        .logo {
            margin-bottom: 30px;
        }
        
        .logo h1 {
            color: #FFD700;
            font-size: 42px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .logo p {
            color: #aaa;
            font-size: 16px;
        }
        
        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #FFD700;
            font-weight: bold;
        }
        
        input {
            width: 100%;
            padding: 15px;
            border: 2px solid #333;
            border-radius: 10px;
            background: #2a2a2a;
            color: white;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }
        
        input:focus {
            border-color: #FFD700;
        }
        
        .main-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: black;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px 0;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .main-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }
        
        .demo-btn {
            background: linear-gradient(45deg, #2196F3, #21CBF3);
            color: white;
        }
        
        .status {
            margin: 20px 0;
            padding: 15px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 215, 0, 0.3);
            display: none;
        }
        
        .status.success {
            background: rgba(0, 255, 0, 0.1);
            border-color: #00ff00;
            color: #00ff00;
        }
        
        .instructions {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 10px;
            font-size: 14px;
            text-align: left;
        }
        
        .instructions h3 {
            color: #FFD700;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
            color: #ccc;
        }
        
        .instructions li {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Logo -->
        <div class="logo">
            <h1>ðŸŽ¬ SCRATCH C</h1>
            <p>Entertainment â€¢ Earnings â€¢ Community</p>
        </div>
        
        <!-- Status Message -->
        <div id="status" class="status success"></div>
        
        <!-- Login Form -->
        <div class="input-group">
            <label>Username</label>
            <input type="text" id="username" placeholder="Enter username" value="demo_user">
        </div>
        
        <div class="input-group">
            <label>Password</label>
            <input type="password" id="password" placeholder="Enter password" value="demo123">
        </div>
        
        <!-- Main Buttons -->
        <button class="main-btn" onclick="login()">
            <span>ðŸ”“</span> Login to Dashboard
        </button>
        
        <button class="main-btn demo-btn" onclick="useDemo()">
            <span>âš¡</span> INSTANT DEMO ACCESS
        </button>
        
        <!-- Instructions -->
        <div class="instructions">
            <h3>ðŸ’¡ How to get started:</h3>
            <ul>
                <li>Click "INSTANT DEMO ACCESS" for guaranteed access</li>
                <li>No backend or internet required for demo</li>
                <li>Full access to all dashboard features</li>
                <li>Works even if backend is down</li>
            </ul>
        </div>
    </div>

    <script>
        // ===== 100% WORKING AUTH SYSTEM =====
        // NO BACKEND CALLS - WORKS OFFLINE
        
        console.log('ðŸš€ Scratch C - Offline Version Loaded');
        
        // Show status message
        function showStatus(message, type = 'success') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
            statusEl.style.display = 'block';
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                statusEl.style.display = 'none';
            }, 3000);
        }
        
        // ===== DEMO MODE - 100% OFFLINE =====
        function useDemo() {
            console.log('ðŸŽ® Activating OFFLINE DEMO MODE...');
            
            // Create demo user data (NO API CALLS)
            const demoUser = {
                _id: 'demo_' + Date.now(),
                username: 'demo_user',
                email: 'demo@scratchc.com',
                balance: 2500,
                credits: 1500,
                role: 'user',
                isDemo: true,
                createdAt: new Date().toISOString(),
                profilePic: '',
                totalEarned: 5000,
                totalSpent: 2500,
                level: 5,
                badges: ['ðŸŽ¯ New User', 'â­ Early Member', 'ðŸ† Demo Champion']
            };
            
            // Generate fake token (NO API CALLS)
            const demoToken = 'demo_token_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            
            // Save to localStorage (NO NETWORK REQUIRED)
            localStorage.setItem('token', demoToken);
            localStorage.setItem('user', JSON.stringify(demoUser));
            
            // Also save to sessionStorage as backup
            sessionStorage.setItem('scratchc_auth', 'demo');
            sessionStorage.setItem('scratchc_user', JSON.stringify(demoUser));
            
            console.log('âœ… Demo user created:', demoUser);
            showStatus('âœ… OFFLINE DEMO ACTIVATED! Redirecting...');
            
            // Force redirect to dashboard after 1 second
            setTimeout(() => {
                console.log('ðŸ”€ Redirecting to dashboard...');
                window.location.href = 'dashboard.html';
            }, 1000);
        }
        
        // ===== SIMPLE LOGIN (WITH OFFLINE FALLBACK) =====
        async function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                showStatus('Please enter username and password', 'error');
                return;
            }
            
            console.log('ðŸ” Login attempt for:', username);
            showStatus('Processing login...');
            
            // TRY 1: Quick backend test (with timeout)
            let backendAvailable = false;
            
            try {
                // Quick test with 2 second timeout
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 2000);
                
                const testResponse = await fetch('http://localhost:3000/api/test', {
                    signal: controller.signal
                }).catch(() => null);
                
                clearTimeout(timeoutId);
                
                if (testResponse && testResponse.ok) {
                    backendAvailable = true;
                }
            } catch (error) {
                console.log('ðŸŒ Backend not reachable');
            }
            
            // If backend is not available, use demo mode
            if (!backendAvailable) {
                console.log('âš ï¸ Backend unavailable, using offline demo');
                useDemo();
                return;
            }
            
            // TRY 2: Actual login (with offline fallback)
            try {
                const response = await fetch('http://localhost:3000/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // Save user data
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data.user));
                    
                    showStatus('âœ… Login successful! Redirecting...');
                    
                    setTimeout(() => {
                        window.location.href = 'dashboard.html';
                    }, 1000);
                    
                } else {
                    // If login fails, use demo mode
                    console.log('âŒ Login failed, using demo mode');
                    useDemo();
                }
                
            } catch (error) {
                // If any error, use demo mode
                console.log('ðŸ’¥ Network error, using offline demo');
                useDemo();
            }
        }
        
        // ===== PAGE LOAD =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… Scratch C OFFLINE Version Ready');
            console.log('ðŸ’¡ Tip: Click "INSTANT DEMO ACCESS" for guaranteed offline access');
            
            // Clear any old demo data
            if (localStorage.getItem('user') && JSON.parse(localStorage.getItem('user')).isDemo) {
                localStorage.clear();
                sessionStorage.clear();
                console.log('ðŸ§¹ Cleared old demo data');
            }
            
            // Auto-focus username field
            setTimeout(() => {
                document.getElementById('username').focus();
            }, 500);
            
            // Handle Enter key
            document.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });
            
            // Welcome message
            setTimeout(() => {
                showStatus('ðŸŽ¬ Welcome to Scratch C! Click INSTANT DEMO to begin');
            }, 1000);
        });
        
        // ===== GLOBAL FUNCTIONS =====
        window.login = login;
        window.useDemo = useDemo;
        
        // Force demo mode from console
        window.forceDemo = function() {
            console.log('âš¡ Force activating demo mode...');
            useDemo();
        };
        
        // Clear everything
        window.clearAll = function() {
            localStorage.clear();
            sessionStorage.clear();
            console.log('ðŸ§¹ All storage cleared');
            location.reload();
        };
    </script>
</body>
  </html>
